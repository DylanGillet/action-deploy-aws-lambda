name: Deploy Python Code to AWS Lambda
author: Daniel Polombo
description: Deploy python code to AWS Lambda
inputs:
  function_name:
    description: the Lambda function name
    required: true
  working_directory:
    description: the Lambda function directory
    required: true
  runtime:
    description: the Lambda function runtime
    required: true
  role:
    description: the Lambda function IAM role
    required: true
  handler:
    description: the Lambda function handler
    required: true
  memory:
    description: the Lambda function memory size in MB
    required: true
  timeout:
    description: the Lambda function time limit in seconds
    required: true
  env_variables:
    description: Environment variables in the format {var1=value1,var2=value2}
    required: false
  vpc_config:
    description: VPC configuration in the format SubnetIds=string,string,SecurityGroupIds=string,string
    required: false
  layers:
    description: Lambda layers ARN
    required: false

runs:
  using: "composite"
  steps:
    - run: echo "${{ github.action_path }}" >> $GITHUB_PATH
      shell: bash
    - run: deploy-lambda.sh
      shell: bash
      env:
        INPUT_FUNCTION_NAME: "${{ inputs.function_name }}"
        INPUT_WORKING_DIRECTORY: "${{ inputs.working_directory }}"
        INPUT_RUNTIME: "${{ inputs.runtime }}"
        INPUT_ROLE: "${{ inputs.role }}"
        INPUT_HANDLER: "${{ inputs.handler }}"
        INPUT_MEMORY: "${{ inputs.memory }}"
        INPUT_TIMEOUT: "${{ inputs.timeout }}"
        INPUT_ENV_VARIABLES: "${{ inputs.env_variables }}"
        INPUT_VPC_CONFIG: "${{ inputs.vpc_config }}"
        INPUT_LAYERS: "${{ inputs.layers }}"
